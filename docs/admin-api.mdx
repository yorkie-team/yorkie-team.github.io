---
title: 'Admin API'
order: 90
---

## Admin API

The Yorkie Admin API allows developers to interact programmatically with their Yorkie documents without using the Yorkie SDK. It is convenient for managing documents in server-side applications.

The API is implemented using [Connect protocol](https://connectrpc.com/docs/protocol/), which means all requests are made using HTTP POST method to a specific service endpoint. The API accepts JSON-encoded request bodies, returns JSON-encoded responses, and uses standard HTTP response codes.

**Base URL**: `{{API_ADDR}}/yorkie.v1.AdminService/`

### Authentication

For APIs that require authentication, you need to add your Project SecretKey to the request's authorization header using the API-Key scheme.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/ListProjects' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{}'
```

### Documents Management

#### POST /yorkie.v1.AdminService/CreateDocument

This endpoint creates a new document in the specified project. If `initial_root` is provided, it is used as the initial content of the document. Otherwise, an empty document is created.

##### Request

Parameters:

- `document_key`: A unique key for the new document.
- `initial_root`: The initial root([YSON string](/docs/advanced/yson)) of the document.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/CreateDocument' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{
    "document_key": "document-1",
    "initial_root": "{\"type\":\"doc\",\"content\":[]}"
  }'
```

##### Response

```bash
{
  "document": {
    "id": "doc_abcdef",
    "key": "document-1",
    "project_name": "my-project",
    "root": "{\"content\":[],\"type\":\"doc\"}",
    "created_at": "2025-05-12T10:00:00.000Z",
    "updated_at": "2025-05-12T10:00:00.000Z"
  }
}
```

#### POST /yorkie.v1.AdminService/UpdateDocument

This endpoint updates the content of an existing document.

##### Request

Parameters:

- `document_key`: The key of the document to update.
- `root`: The new root content ([YSON string](/docs/advanced/yson)) of the document.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/UpdateDocument' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{
    "document_key": "document-1",
    "root": "{\"type\":\"doc\",\"content\":[{\"type\":\"paragraph\",\"content\":[{\"text\":\"Updated content\",\"type\":\"text\"}]}]}"
  }'
```

##### Response

```json
{
  "document": {
    "id": "doc_12345",
    "key": "document-1",
    "project_name": "my-project",
    "root": "{\"type\":\"doc\",\"content\":[{\"type\":\"paragraph\",\"content\":[{\"text\":\"Updated content\",\"type\":\"text\"}]}]}",
    "created_at": "2025-03-24T12:00:00.000Z",
    "updated_at": "2025-05-12T11:30:00.000Z"
  }
}
```

#### POST /yorkie.v1.AdminService/ListDocuments

This endpoint returns a list of documents in a project. A pagination mechanism allows you to retrieve documents in batches. Provide the `previous_id` of the last document in the previous page to get the next page of documents.

To include the root of each document in the response, set the `include_root` parameter to `true`.

##### Request

Parameters:
- `previous_id`: The ID of the last document in the previous page. If not provided, the first page will be returned.
- `page_size`: The number of documents to return.
- `is_forward`: Whether to return documents in ascending order.
- `include_root`: Whether to include root in the response.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/ListDocuments' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{
    "previous_id": "doc_last_id",
    "page_size": 20,
    "is_forward": true,
    "include_root": false
  }'
```

##### Response
```json
{
  "documents": [
    {
      "id": "doc_12345",
      "key": "document-1",
      "project_name": "my-project",
      "created_at": "2025-03-24T12:00:00.000Z",
      "updated_at": "2025-03-24T13:00:00.000Z",
      "root": "..."
    },
    {
      "id": "doc_67890",
      "key": "document-2",
      "project_name": "my-project",
      "created_at": "2025-03-23T10:00:00.000Z",
      "updated_at": "2025-03-24T09:30:00.000Z",
      "root": "..."
    }
  ]
}
```

#### POST /yorkie.v1.AdminService/GetDocument

This endpoint returns a document by its key.

##### Request

Parameters:
- `document_key`: The key of the document.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/GetDocument' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{
    "document_key": "document-1"
  }'
```

##### Response
```json
{
  "document": {
    "id": "doc_12345",
    "key": "document-1",
    "project_name": "my-project",
    "created_at": "2025-03-24T12:00:00.000Z",
    "updated_at": "2025-03-24T13:00:00.000Z"
  }
}
```

#### POST /yorkie.v1.AdminService/GetDocuments

Get multiple documents by their keys.

##### Request

Parameters:
- `document_keys`: An array of document keys.
- `include_root`: Whether to include root in the response.
- `include_presences`: Whether to include presences in the response.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/GetDocuments' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{
    "document_keys": ["document-1", "document-2"],
    "include_root": false,
    "include_presences": false
  }'
```

##### Response
```json
{
  "documents": [
    {
      "id": "doc_12345",
      "key": "document-1",
      "project_name": "my-project",
      "created_at": "2025-03-24T12:00:00.000Z",
      "updated_at": "2025-03-24T13:00:00.000Z",
      "root": "...",
      "presences": "..."
    },
    {
      "id": "doc_67890",
      "key": "document-2",
      "project_name": "my-project",
      "created_at": "2025-03-23T10:00:00.000Z",
      "updated_at": "2025-03-24T09:30:00.000Z",
      "root": "...",
      "presences": "..."
    }
  ]
}
```

#### POST /yorkie.v1.AdminService/RemoveDocumentByAdmin

Remove a document.

##### Request

Parameters:
- `document_key`: The key of the document.
- `force`: Whether to force remove the document even if it is attached to clients.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/RemoveDocumentByAdmin' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{
    "document_key": "document-1",
    "force": false
  }'
```

##### Response
Empty response with success status code.

#### POST /yorkie.v1.AdminService/GetSnapshotMeta

Get snapshot metadata for a document.

##### Request

Parameters:
- `document_key`: The key of the document.
- `server_seq`: The server sequence number of the snapshot.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/GetSnapshotMeta' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{
    "document_key": "document-1",
    "server_seq": 42
  }'
```

##### Response
```json
{
  "snapshot": "base64-encoded-snapshot-data",
  "lamport": 42,
  "version_vector": {
    "client1": 5,
    "client2": 3
  }
}
```

#### POST /yorkie.v1.AdminService/SearchDocuments
Search for documents in a project.

##### Request

Parameters:
- `query`: The prefix of the document key to search for.
- `page_size`: The number of documents to return.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/SearchDocuments' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{
    "query": "search term",
    "page_size": 20
  }'
```

##### Response
```json
{
  "total_count": 5,
  "documents": [
    {
      "id": "doc_12345",
      "key": "document-1",
      "project_name": "my-project",
      "created_at": "2025-03-24T12:00:00.000Z",
      "updated_at": "2025-03-24T13:00:00.000Z"
    },
    {
      "id": "doc_67890",
      "key": "document-2",
      "project_name": "my-project",
      "created_at": "2025-03-23T10:00:00.000Z",
      "updated_at": "2025-03-24T09:30:00.000Z"
    }
  ]
}
```

### Channel Management

#### POST /yorkie.v1.AdminService/GetChannels

This endpoint retrieves channel information without requiring an SDK client to attach to the channels. It returns the session count (the number of connected clients) for the specified channels.

Channels support [hierarchical keys using periods (`.`) as separators](/docs/js-sdk#hierarchical-channel-keys). When `include_sub_path` is enabled, the session count includes all clients connected to sub-level channels.

##### Request

Parameters:

- `channel_keys`: An array of channel keys to retrieve information for.
- `include_sub_path`: Whether to include session counts from sub-level channels in the total count.

```bash
curl '{{API_ADDR}}/yorkie.v1.AdminService/GetChannels' \
  -H 'content-type: application/json' \
  -H 'authorization: API-Key PROJECT_SECRET_KEY' \
  --data-raw '{
    "channel_keys": ["room-1", "room-1.section-1"],
    "include_sub_path": false
  }'
```

##### Response

If `room-1` has 10 direct connections and `room-1.section-1` has 20 connections, the response would be:

**Case 1: Get exact channel session counts (`include_sub_path: false`)**

When `include_sub_path` is `false`, the `sessionCount` for a channel includes only the direct connections to that channel.
In this case, the session count for `room-1` would be 10 and the session count for `room-1.section-1` would be 20.

```json
{
  "channels": [
    {
      "key": "room-1",
      "sessionCount": 10
    },
    {
      "key": "room-1.section-1",
      "sessionCount": 20
    }
  ]
}
```

**Case 2: Get channel session counts including sub-levels (`include_sub_path: true`)**

When `include_sub_path` is `true`, the `sessionCount` for a channel includes all clients connected to that channel and any sub-level channels. 
In this case, the total session count for `room-1` would include both 10 and 20, totaling 30.

```json
{
  "channels": [
    {
      "key": "room-1",
      "sessionCount": 30
    },
    {
      "key": "room-1.section-1",
      "sessionCount": 20
    }
  ]
}
```
