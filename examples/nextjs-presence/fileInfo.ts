import { DirectoryInfo } from '@/utils/exampleFileUtils';
        export const FILE_INFO: DirectoryInfo = {"isFile":false,"name":"nextjs-presence","path":"/","children":[{"isFile":false,"name":"lib","path":"/lib","children":[{"isFile":true,"isOpen":false,"language":"typescript","name":"rooms.ts","path":"/lib/rooms.ts","content":"// Available rooms with their metadata\nexport const ROOMS = [\n  {\n    id: 'general',\n    name: 'üí¨ General',\n    description: 'General discussion',\n    key: 'room.general',\n  },\n  {\n    id: 'dev',\n    name: 'üíª Development',\n    description: 'Tech talk and coding',\n    key: 'room.dev',\n  },\n  {\n    id: 'random',\n    name: 'üé≤ Random',\n    description: 'Off-topic chat',\n    key: 'room.random',\n  },\n  {\n    id: 'music',\n    name: 'üéµ Music',\n    description: 'Share your favorite tunes',\n    key: 'room.music',\n  },\n];\n"}]},{"isFile":false,"name":"components","path":"/components","children":[{"isFile":true,"isOpen":false,"language":"css","name":"PresenceCounter.css","path":"/components/PresenceCounter.css","content":".presence-counter {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 2rem;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  border-radius: 15px;\n  color: white;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n  margin: 2rem 0;\n  min-height: 180px;\n  justify-content: center;\n  position: relative;\n}\n\n.presence-counter.loading,\n.presence-counter.error {\n  flex-direction: row;\n  gap: 1rem;\n  justify-content: center;\n  align-items: center;\n  min-height: 120px;\n}\n\n.presence-counter.error {\n  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\n}\n\n.spinner {\n  width: 24px;\n  height: 24px;\n  border: 3px solid rgba(255, 255, 255, 0.3);\n  border-top-color: white;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.error-icon {\n  font-size: 1.5rem;\n}\n\n.presence-status {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  margin-bottom: 1rem;\n  font-size: 0.9rem;\n  font-weight: 500;\n  opacity: 0.9;\n}\n\n.status-indicator {\n  width: 10px;\n  height: 10px;\n  border-radius: 50%;\n  background: #10b981;\n  box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);\n  animation: pulse 2s ease-in-out infinite;\n}\n\n@keyframes pulse {\n  0%,\n  100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n\n.presence-count {\n  text-align: center;\n  transition: transform 0.3s ease;\n}\n\n.presence-count.increase {\n  animation: countIncrease 0.6s ease;\n}\n\n.presence-count.decrease {\n  animation: countDecrease 0.6s ease;\n}\n\n@keyframes countIncrease {\n  0% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(1.2);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n\n@keyframes countDecrease {\n  0% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(0.9);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n\n.count-value {\n  font-size: 4rem;\n  font-weight: 700;\n  line-height: 1;\n  margin-bottom: 0.5rem;\n  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n}\n\n.count-label {\n  font-size: 1.2rem;\n  font-weight: 500;\n  opacity: 0.9;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n}\n\n.presence-change {\n  position: absolute;\n  bottom: -1rem;\n  animation: slideUp 0.5s ease;\n}\n\n@keyframes slideUp {\n  from {\n    transform: translateY(10px);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n\n.change-badge {\n  display: inline-block;\n  padding: 0.5rem 1rem;\n  border-radius: 20px;\n  font-size: 0.9rem;\n  font-weight: 600;\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n}\n\n.change-badge.join {\n  background: #10b981;\n  color: white;\n}\n\n.change-badge.leave {\n  background: #f59e0b;\n  color: white;\n}\n\n/* Simple counter styles */\n.simple-counter {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 1rem;\n  background: #10b981;\n  color: white;\n  border-radius: 20px;\n  font-weight: 600;\n  box-shadow: 0 2px 10px rgba(16, 185, 129, 0.3);\n}\n\n.online-dot {\n  width: 8px;\n  height: 8px;\n  background: white;\n  border-radius: 50%;\n  animation: pulse 2s ease-in-out infinite;\n}\n\n@media (max-width: 768px) {\n  .presence-counter {\n    padding: 1.5rem;\n    margin: 1rem 0;\n  }\n\n  .count-value {\n    font-size: 3rem;\n  }\n\n  .count-label {\n    font-size: 1rem;\n  }\n\n  .change-badge {\n    font-size: 0.8rem;\n    padding: 0.4rem 0.8rem;\n  }\n}\n"},{"isFile":true,"isOpen":false,"language":"tsx","name":"PresenceCounter.tsx","path":"/components/PresenceCounter.tsx","content":"'use client';\n\nimport { useChannel } from '@yorkie-js/react';\nimport { useEffect, useState } from 'react';\nimport './PresenceCounter.css';\n\nfunction PresenceCounter() {\n  const { count, loading, error } = useChannel();\n  const [prevCount, setPrevCount] = useState(0);\n  const [isIncreasing, setIsIncreasing] = useState<boolean | null>(null);\n\n  useEffect(() => {\n    if (!loading && count !== prevCount) {\n      setIsIncreasing(count > prevCount);\n      setPrevCount(count);\n\n      // Clear the animation state after animation completes\n      const timer = setTimeout(() => {\n        setIsIncreasing(null);\n      }, 600);\n\n      return () => clearTimeout(timer);\n    }\n  }, [count, loading, prevCount]);\n\n  if (loading) {\n    return (\n      <div className=\"presence-counter loading\">\n        <div className=\"spinner\"></div>\n        <p>Connecting to room...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"presence-counter error\">\n        <span className=\"error-icon\">‚ö†Ô∏è</span>\n        <p>Error: {error.message}</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"presence-counter\">\n      <div className=\"presence-status\">\n        <span className=\"status-indicator online\"></span>\n        <span className=\"status-text\">Live</span>\n      </div>\n\n      <div\n        className={`presence-count ${isIncreasing === true ? 'increase' : ''} ${\n          isIncreasing === false ? 'decrease' : ''\n        }`}\n      >\n        <div className=\"count-value\">{count}</div>\n        <div className=\"count-label\">\n          {count === 1 ? 'user online' : 'users online'}\n        </div>\n      </div>\n\n      {isIncreasing !== null && (\n        <div className=\"presence-change\">\n          {isIncreasing ? (\n            <span className=\"change-badge join\">üëã Someone joined!</span>\n          ) : (\n            <span className=\"change-badge leave\">üëã Someone left</span>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Alternative simpler component using only usePresenceCount hook\nexport function SimplePresenceCounter() {\n  const count = useChannel().count;\n\n  return (\n    <div className=\"simple-counter\">\n      <span className=\"online-dot\"></span>\n      <span>{count} online</span>\n    </div>\n  );\n}\n\nexport default PresenceCounter;\n"},{"isFile":true,"isOpen":false,"language":"css","name":"RoomSelector.css","path":"/components/RoomSelector.css","content":".room-selector {\n  max-width: 900px;\n  width: 100%;\n  padding: 2rem;\n  background: white;\n  border-radius: 20px;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n}\n\n.room-selector-header {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 1rem;\n  flex-wrap: wrap;\n  margin-bottom: 0.5rem;\n}\n\n.room-selector h2 {\n  font-size: 2rem;\n  margin: 0;\n  color: #333;\n}\n\n.room-selector-badge {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 28px;\n  height: 28px;\n  padding: 0 10px;\n  background: rgba(102, 126, 234, 0.15);\n  backdrop-filter: blur(10px);\n  border: 2px solid rgba(102, 126, 234, 0.3);\n  border-radius: 14px;\n  font-size: 0.85rem;\n  font-weight: 700;\n  color: #667eea;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  transition: all 0.3s ease;\n  float: right;\n}\n\n.room-selector-subtitle {\n  text-align: center;\n  color: #666;\n  margin-bottom: 2rem;\n  font-size: 1.1rem;\n}\n\n.room-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n  gap: 1.5rem;\n  margin-bottom: 2rem;\n}\n\n.room-card {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  border: none;\n  border-radius: 15px;\n  padding: 1.5rem;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  color: white;\n  text-align: left;\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n  position: relative;\n}\n\n.room-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n}\n\n.room-card:active {\n  transform: translateY(-2px);\n}\n\n.room-card-header {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n}\n\n.room-card-header h3 {\n  font-size: 1.5rem;\n  margin: 0;\n  font-weight: 600;\n  flex: 1;\n}\n\n.room-card-badge {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 28px;\n  height: 28px;\n  padding: 0 10px;\n  background: rgba(255, 255, 255, 0.25);\n  backdrop-filter: blur(10px);\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  border-radius: 14px;\n  font-size: 0.85rem;\n  font-weight: 700;\n  color: white;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n  transition: all 0.3s ease;\n}\n\n.room-card-description {\n  color: rgba(255, 255, 255, 0.9);\n  margin-bottom: 1rem;\n  font-size: 0.95rem;\n  line-height: 1.5;\n}\n\n.room-card-action {\n  display: flex;\n  justify-content: flex-end;\n  opacity: 0.9;\n  font-weight: 500;\n}\n\n.room-selector-tip {\n  text-align: center;\n  padding: 1rem;\n  background: #f8f9fa;\n  border-radius: 10px;\n  color: #666;\n  font-size: 0.95rem;\n}\n\n@media (prefers-color-scheme: dark) {\n  .room-selector {\n    background: #1a1a1a;\n  }\n\n  .room-selector h2 {\n    color: #fff;\n  }\n\n  .room-selector-badge {\n    background: rgba(102, 126, 234, 0.25);\n    border-color: rgba(102, 126, 234, 0.4);\n    color: #9db4ff;\n  }\n\n  .room-selector-subtitle {\n    color: #aaa;\n  }\n\n  .room-selector-tip {\n    background: #2a2a2a;\n    color: #aaa;\n  }\n}\n\n@media (max-width: 768px) {\n  .room-selector {\n    padding: 1.5rem;\n  }\n\n  .room-selector-header {\n    gap: 0.75rem;\n  }\n\n  .room-selector h2 {\n    font-size: 1.5rem;\n  }\n\n  .room-selector-badge {\n    font-size: 0.75rem;\n    min-width: 24px;\n    height: 24px;\n    padding: 0 8px;\n  }\n\n  .room-grid {\n    grid-template-columns: 1fr;\n    gap: 1rem;\n  }\n\n  .room-card {\n    padding: 1.25rem;\n  }\n}\n"},{"isFile":true,"isOpen":false,"language":"tsx","name":"RoomSelector.tsx","path":"/components/RoomSelector.tsx","content":"import { ROOMS } from '@/lib/rooms';\nimport './RoomSelector.css';\n\ninterface RoomSelectorProps {\n  onRoomSelect: (roomId: string) => void;\n  presences: { key: string; presenceCount: number }[];\n}\n\nfunction RoomSelector({ onRoomSelect, presences }: RoomSelectorProps) {\n  const totalCount =\n    presences.find((p) => p.key === 'room')?.presenceCount ?? 0;\n  return (\n    <div className=\"room-selector\">\n      <h2>\n        Choose a Room\n        <span className=\"room-selector-badge\">{totalCount} users</span>\n      </h2>\n      <p className=\"room-selector-subtitle\">\n        Join a room to see who else is online\n      </p>\n\n      <div className=\"room-grid\">\n        {ROOMS.map((room) => {\n          const presenceCount =\n            presences.find((p) => p.key === room.key)?.presenceCount || 0;\n          return (\n            <button\n              key={room.id}\n              className=\"room-card\"\n              onClick={() => onRoomSelect(room.id)}\n            >\n              <div className=\"room-card-header\">\n                <h3>{room.name}</h3>\n                <span className=\"room-card-badge\">{presenceCount} users</span>\n              </div>\n              <p className=\"room-card-description\">{room.description}</p>\n              <div className=\"room-card-action\">\n                <span>Join Room ‚Üí</span>\n              </div>\n            </button>\n          );\n        })}\n      </div>\n\n      <div className=\"room-selector-tip\">\n        üí° Tip: Open multiple browser windows to test presence tracking!\n      </div>\n    </div>\n  );\n}\n\nexport default RoomSelector;\n"},{"isFile":true,"isOpen":false,"language":"css","name":"RoomView.css","path":"/components/RoomView.css","content":".room-view {\n  max-width: 800px;\n  width: 100%;\n  background: white;\n  border-radius: 20px;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  overflow: hidden;\n}\n\n.room-view.error {\n  padding: 2rem;\n  text-align: center;\n}\n\n.room-view-header {\n  padding: 1.5rem 2rem;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n}\n\n.back-button {\n  background: rgba(255, 255, 255, 0.2);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  color: white;\n  padding: 0.5rem 1rem;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 0.95rem;\n  font-weight: 500;\n  transition: all 0.2s;\n  backdrop-filter: blur(10px);\n}\n\n.back-button:hover {\n  background: rgba(255, 255, 255, 0.3);\n  transform: translateX(-2px);\n}\n\n.room-view-content {\n  padding: 2rem;\n}\n\n.room-info {\n  text-align: center;\n  margin-bottom: 2rem;\n}\n\n.room-info h2 {\n  font-size: 2rem;\n  margin-bottom: 0.5rem;\n  color: #333;\n}\n\n.room-info p {\n  color: #666;\n  font-size: 1.1rem;\n}\n\n.room-instructions {\n  background: #f8f9fa;\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-top: 2rem;\n}\n\n.room-instructions h3 {\n  color: #333;\n  margin-bottom: 1rem;\n  font-size: 1.3rem;\n}\n\n.room-instructions ul {\n  list-style: none;\n  padding: 0;\n}\n\n.room-instructions li {\n  padding: 0.5rem 0;\n  color: #555;\n  font-size: 1rem;\n  line-height: 1.6;\n}\n\n.room-demo-area {\n  margin-top: 2rem;\n  padding: 1.5rem;\n  background: linear-gradient(\n    135deg,\n    rgba(102, 126, 234, 0.1) 0%,\n    rgba(118, 75, 162, 0.1) 100%\n  );\n  border-radius: 12px;\n  border: 2px solid rgba(102, 126, 234, 0.2);\n}\n\n.room-demo-area h3 {\n  color: #667eea;\n  margin-bottom: 0.75rem;\n  font-size: 1.3rem;\n}\n\n.room-demo-area p {\n  color: #555;\n  margin-bottom: 0.5rem;\n  line-height: 1.6;\n}\n\n.room-demo-area code {\n  background: rgba(102, 126, 234, 0.1);\n  padding: 0.2rem 0.5rem;\n  border-radius: 4px;\n  font-family: 'Courier New', monospace;\n  color: #764ba2;\n  font-weight: 600;\n}\n\n.demo-hint {\n  font-size: 0.9rem;\n  color: #777;\n  margin-top: 0.5rem;\n}\n\n@media (prefers-color-scheme: dark) {\n  .room-view {\n    background: #1a1a1a;\n  }\n\n  .room-info h2 {\n    color: #fff;\n  }\n\n  .room-info p {\n    color: #aaa;\n  }\n\n  .room-instructions {\n    background: #2a2a2a;\n  }\n\n  .room-instructions h3 {\n    color: #fff;\n  }\n\n  .room-instructions li {\n    color: #ccc;\n  }\n\n  .room-demo-area {\n    background: rgba(102, 126, 234, 0.15);\n    border-color: rgba(102, 126, 234, 0.3);\n  }\n\n  .room-demo-area p {\n    color: #ccc;\n  }\n\n  .room-demo-area code {\n    background: rgba(102, 126, 234, 0.2);\n    color: #a78bfa;\n  }\n\n  .demo-hint {\n    color: #999;\n  }\n}\n\n@media (max-width: 768px) {\n  .room-view-header {\n    padding: 1rem 1.5rem;\n  }\n\n  .room-view-content {\n    padding: 1.5rem;\n  }\n\n  .room-info h2 {\n    font-size: 1.5rem;\n  }\n\n  .room-instructions,\n  .room-demo-area {\n    padding: 1rem;\n  }\n\n  .room-instructions h3,\n  .room-demo-area h3 {\n    font-size: 1.1rem;\n  }\n}\n"},{"isFile":true,"isOpen":false,"language":"tsx","name":"RoomView.tsx","path":"/components/RoomView.tsx","content":"'use client';\n\nimport { ChannelProvider } from '@yorkie-js/react';\nimport { ROOMS } from '@/lib/rooms';\nimport PresenceCounter from './PresenceCounter';\nimport './RoomView.css';\n\ninterface RoomViewProps {\n  roomId: string;\n  onLeave: () => void;\n}\n\nfunction RoomView({ roomId, onLeave }: RoomViewProps) {\n  const room = ROOMS.find((r) => r.id === roomId);\n\n  if (!room) {\n    return (\n      <div className=\"room-view error\">\n        <p>Room not found</p>\n        <button onClick={onLeave}>Go Back</button>\n      </div>\n    );\n  }\n\n  return (\n    <ChannelProvider channelKey={room.key} isRealtime={true}>\n      <div className=\"room-view\">\n        <div className=\"room-view-header\">\n          <button className=\"back-button\" onClick={onLeave}>\n            ‚Üê Back to Rooms\n          </button>\n        </div>\n\n        <div className=\"room-view-content\">\n          <div className=\"room-info\">\n            <h2>{room.name}</h2>\n            <p>{room.description}</p>\n          </div>\n\n          <PresenceCounter />\n\n          <div className=\"room-instructions\">\n            <h3>Try it out!</h3>\n            <ul>\n              <li>ü™ü Open this page in multiple browser windows or tabs</li>\n              <li>\n                üëÄ Watch the user count update in real-time as you join/leave\n              </li>\n              <li>üè† Switch rooms to see independent presence tracking</li>\n            </ul>\n          </div>\n\n          <div className=\"room-demo-area\">\n            <h3>You&apos;re connected!</h3>\n            <p>\n              This is room <strong>{room.id}</strong> with presence key:{' '}\n              <code>{room.key}</code>\n            </p>\n            <p className=\"demo-hint\">\n              Each room has its own presence key, allowing independent user\n              counting.\n            </p>\n          </div>\n        </div>\n      </div>\n    </ChannelProvider>\n  );\n}\n\nexport default RoomView;\n"}]},{"isFile":false,"name":"app","path":"/app","children":[{"isFile":false,"name":"api","path":"/app/api","children":[{"isFile":false,"name":"channels","path":"/app/api/channels","children":[{"isFile":true,"isOpen":false,"language":"typescript","name":"route.ts","path":"/app/api/channels/route.ts","content":"export async function POST(request: Request) {\n  try {\n    // Check if secret key is available (required for admin API)\n    const secretKey = process.env.YORKIE_API_SECRET_KEY;\n    if (!secretKey) {\n      return Response.json(\n        { error: 'API server features not available in static hosting mode' },\n        { status: 503 },\n      );\n    }\n\n    const { channel_keys, include_sub_path } = await request.json();\n\n    const url = `${process.env.NEXT_PUBLIC_YORKIE_API_ADDR}/yorkie.v1.AdminService/GetChannels`;\n\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `API-Key ${secretKey}`,\n      },\n      body: JSON.stringify({\n        channel_keys,\n        include_sub_path,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch channels: ${response.statusText}`);\n    }\n\n    const data = await response.json();\n    return Response.json(data);\n  } catch (error) {\n    console.error('Error fetching channels:', error);\n    return Response.json(\n      { error: 'Failed to fetch channels' },\n      { status: 500 },\n    );\n  }\n}\n"}]}]},{"isFile":true,"isOpen":false,"language":"css","name":"App.css","path":"/app/App.css","content":".app {\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n}\n\n.app-header {\n  text-align: center;\n  padding: 2rem 1rem;\n  color: white;\n  background: rgba(0, 0, 0, 0.2);\n  backdrop-filter: blur(10px);\n}\n\n.app-header h1 {\n  font-size: 2.5rem;\n  margin-bottom: 0.5rem;\n  font-weight: 700;\n}\n\n.app-header p {\n  font-size: 1.1rem;\n  opacity: 0.9;\n}\n\n.app-main {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem 1rem;\n}\n\n.app-footer {\n  text-align: center;\n  padding: 1.5rem 1rem;\n  color: white;\n  background: rgba(0, 0, 0, 0.2);\n  backdrop-filter: blur(10px);\n  font-size: 0.9rem;\n}\n\n.app-footer a {\n  color: white;\n  text-decoration: underline;\n  transition: opacity 0.2s;\n}\n\n.app-footer a:hover {\n  opacity: 0.8;\n}\n\n@media (max-width: 768px) {\n  .app-header h1 {\n    font-size: 2rem;\n  }\n\n  .app-header p {\n    font-size: 1rem;\n  }\n\n  .app-main {\n    padding: 1rem;\n  }\n}\n"},{"isFile":true,"isOpen":false,"language":"css","name":"globals.css","path":"/app/globals.css","content":"* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\nbody {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n    sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\nbutton {\n  font-family: inherit;\n}\n"},{"isFile":true,"isOpen":false,"language":"tsx","name":"layout.tsx","path":"/app/layout.tsx","content":"import type { Metadata } from 'next';\nimport './globals.css';\n\nexport const metadata: Metadata = {\n  title: 'Yorkie Presence Rooms',\n  description:\n    'Real-time user presence tracking across multiple rooms using Yorkie',\n};\n\nexport default function RootLayout({\n  children,\n}: Readonly<{\n  children: React.ReactNode;\n}>) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  );\n}\n"},{"isFile":true,"isOpen":false,"language":"tsx","name":"page.tsx","path":"/app/page.tsx","content":"'use client';\n\nimport { useEffect, useState } from 'react';\nimport { YorkieProvider } from '@yorkie-js/react';\nimport RoomSelector from '@/components/RoomSelector';\nimport RoomView from '@/components/RoomView';\nimport { ROOMS } from '@/lib/rooms';\nimport './App.css';\n\nfunction App() {\n  const [currentRoom, setCurrentRoom] = useState<string | null>(null);\n  const [presences, setPresences] = useState<\n    { key: string; presenceCount: number }[]\n  >([]);\n\n  useEffect(() => {\n    if (currentRoom !== null) {\n      return;\n    }\n\n    const fetchChannels = async () => {\n      try {\n        const response = await fetch('/api/channels', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            channel_keys: ['room', ...ROOMS.map((room) => room.key)],\n            include_sub_path: true,\n          }),\n        });\n        const data = await response.json();\n        const roomPresences = ROOMS.map((room) => {\n          const presenceCount =\n            data.channels?.find((ch) => ch.key === room.key)?.presenceCount ??\n            0;\n          return {\n            key: room.key,\n            presenceCount: presenceCount,\n          };\n        });\n\n        const roomChannel = data.channels?.find((ch) => ch.key === 'room');\n        const totalPresence = {\n          key: 'room',\n          presenceCount: roomChannel?.presenceCount ?? 0,\n        };\n\n        setPresences([totalPresence, ...roomPresences]);\n      } catch (error) {\n        console.error('Failed to fetch channels:', error);\n        // Fallback to zero presence counts on error (e.g., static hosting mode)\n        const fallbackPresences = ROOMS.map((room) => ({\n          key: room.key,\n          presenceCount: 0,\n        }));\n        setPresences(fallbackPresences);\n      }\n    };\n\n    fetchChannels();\n  }, [currentRoom]);\n\n  return (\n    <YorkieProvider\n      apiKey={process.env.NEXT_PUBLIC_YORKIE_API_KEY || ''}\n      rpcAddr={\n        process.env.NEXT_PUBLIC_YORKIE_API_ADDR || 'http://localhost:8080'\n      }\n    >\n      <div className=\"app\">\n        <header className=\"app-header\">\n          <div className=\"app-header-title\">\n            <h1>Yorkie Presence Rooms</h1>\n          </div>\n          <p>Real-time user presence tracking across multiple rooms</p>\n        </header>\n\n        <main className=\"app-main\">\n          {currentRoom ? (\n            <RoomView\n              roomId={currentRoom}\n              onLeave={() => setCurrentRoom(null)}\n            />\n          ) : (\n            <RoomSelector onRoomSelect={setCurrentRoom} presences={presences} />\n          )}\n        </main>\n\n        <footer className=\"app-footer\">\n          <p>\n            Open multiple browser windows to see real-time presence updates! ‚Ä¢{' '}\n            <a\n              href=\"https://github.com/yorkie-team/yorkie-js-sdk\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              View on GitHub\n            </a>\n          </p>\n        </footer>\n      </div>\n    </YorkieProvider>\n  );\n}\n\nexport default App;\n"}]},{"isFile":true,"isOpen":false,"language":"","name":".env","path":"/.env","content":"# Yorkie API Keys (Client-side - safe to expose)\nNEXT_PUBLIC_YORKIE_API_ADDR=http://localhost:8080\nNEXT_PUBLIC_YORKIE_API_KEY=''\n\n# Yorkie Secret Key (Server-side only - DO NOT expose to client)\n# This is used in API routes to enable server-side features\n# Leave empty for static hosting (e.g., GitHub Pages)\nYORKIE_API_SECRET_KEY=''\n"},{"isFile":true,"isOpen":false,"language":"production","name":".env.production","path":"/.env.production","content":""},{"isFile":true,"isOpen":false,"language":"","name":".gitignore","path":"/.gitignore","content":"# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.\n\n# dependencies\n/node_modules\n/.pnp\n.pnp.js\n\n# testing\n/coverage\n\n# next.js\n/.next/\n/out/\n/dist/\n\n# production\n/build\n\n# misc\n.DS_Store\n*.pem\n\n# debug\nnpm-debug.log*\nyarn-debug.log*\nyarn-error.log*\n\n# local env files\n.env*.local\n\n# vercel\n.vercel\n\n# typescript\n*.tsbuildinfo\nnext-env.d.ts\n"},{"isFile":true,"isOpen":false,"language":"markdown","name":"README.md","path":"/README.md","content":"# Yorkie Presence Rooms - Next.js Example\n\nA Next.js application demonstrating real-time user presence tracking across multiple rooms using [Yorkie](https://yorkie.dev).\n\n## üöÄ Features\n\n- **Multiple Rooms**: Switch between different chat rooms with independent presence tracking\n- **Real-time Updates**: See users join and leave in real-time\n- **Secure API Handling**: Secret keys are handled server-side via Next.js API Routes\n- **Beautiful UI**: Modern gradient design with smooth animations\n- **Responsive**: Works great on desktop and mobile devices\n\n## üîí Security\n\nThis example supports two deployment modes:\n\n### 1. Full-Featured Mode (with API Routes)\n\nUses **Next.js API Routes** to securely handle the Yorkie Admin API calls that require a secret key. The secret key is never exposed to the client browser.\n\n**Architecture:**\n\n- **Client Side**: Uses `NEXT_PUBLIC_YORKIE_API_KEY` for user authentication\n- **Server Side (API Route)**: Uses `YORKIE_API_SECRET_KEY` for admin operations\n- **API Endpoint**: `/api/channels` handles secure server-side requests to Yorkie's Admin API\n- **Features**: Shows real-time presence counts for all rooms\n\n### 2. Static Hosting Mode (GitHub Pages, etc.)\n\nWhen deployed to static hosting platforms without a backend, the example still works with basic functionality.\n\n**Architecture:**\n\n- **Client Side Only**: Uses `NEXT_PUBLIC_YORKIE_API_KEY` for user authentication\n- **No Secret Key**: Leave `YORKIE_API_SECRET_KEY` empty\n- **Features**: Room presence tracking works, but initial presence counts show as 0\n\n## üìã Prerequisites\n\n- Node.js 18+ and pnpm\n- A Yorkie account with API keys from [Yorkie Dashboard](https://yorkie.dev/dashboard)\n\n## üõ†Ô∏è Setup\n\n1. Clone the repository and navigate to this example:\n\n```bash\ncd examples/nextjs-presence\n```\n\n2. Install dependencies:\n\n```bash\npnpm install\n```\n\n3. Create a `.env.local` file in the root of this example with your Yorkie credentials:\n\n**For Full-Featured Mode (with server):**\n\n```bash\n# Client-side API key (safe to expose)\nNEXT_PUBLIC_YORKIE_API_KEY=your-api-key-here\nNEXT_PUBLIC_YORKIE_API_ADDR=https://api.yorkie.dev\n\n# Server-side secret key (NEVER expose to client)\n# Setting this enables API server features\nYORKIE_API_SECRET_KEY=your-secret-key-here\n```\n\n**For Static Hosting Mode (GitHub Pages, etc.):**\n\n```bash\n# Client-side API key (safe to expose)\nNEXT_PUBLIC_YORKIE_API_KEY=your-api-key-here\nNEXT_PUBLIC_YORKIE_API_ADDR=https://api.yorkie.dev\n\n# Leave secret key empty for static hosting\nYORKIE_API_SECRET_KEY=\n```\n\n> ‚ö†Ô∏è **Important**: Never commit your `.env.local` file or expose your secret key in client-side code!\n\n## üèÉ Running the Example\n\n```bash\n# Development mode\npnpm dev\n\n# Production build\npnpm build\npnpm start\n```\n\nOpen [http://localhost:3000](http://localhost:3000) in multiple browser windows to see presence tracking in action!\n\n## üìÅ Project Structure\n\n```\nnextjs-presence/\n‚îú‚îÄ‚îÄ app/\n‚îÇ   ‚îú‚îÄ‚îÄ api/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ channels/\n‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ route.ts          # Server-side API route (uses secret key)\n‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx                # Root layout\n‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                  # Main app component\n‚îÇ   ‚îú‚îÄ‚îÄ App.css                   # App styles\n‚îÇ   ‚îî‚îÄ‚îÄ globals.css               # Global styles\n‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îú‚îÄ‚îÄ RoomSelector.tsx          # Room selection component\n‚îÇ   ‚îú‚îÄ‚îÄ RoomSelector.css\n‚îÇ   ‚îú‚îÄ‚îÄ RoomView.tsx              # Individual room view\n‚îÇ   ‚îú‚îÄ‚îÄ RoomView.css\n‚îÇ   ‚îú‚îÄ‚îÄ PresenceCounter.tsx       # Presence counter component\n‚îÇ   ‚îî‚îÄ‚îÄ PresenceCounter.css\n‚îú‚îÄ‚îÄ .env                          # Example env file\n‚îú‚îÄ‚îÄ .env.production               # Production env template\n‚îú‚îÄ‚îÄ package.json\n‚îú‚îÄ‚îÄ next.config.ts\n‚îî‚îÄ‚îÄ README.md\n```\n\n## üéØ How It Works\n\n1. **Room Selection**: Users select a room from the main screen\n2. **API Route**: Client fetches presence data from `/api/channels` (server-side)\n3. **Server Request**: API route uses secret key to call Yorkie Admin API\n4. **Real-time Connection**: Upon entering a room, client connects with `ChannelProvider`\n5. **Presence Tracking**: `useChannel` hook tracks real-time user count\n6. **Live Updates**: UI updates automatically as users join/leave\n\n## üîë Environment Variables\n\n### Client-side (NEXT*PUBLIC*\\*)\n\n- `NEXT_PUBLIC_YORKIE_API_KEY`: Your Yorkie API key for client authentication\n- `NEXT_PUBLIC_YORKIE_API_ADDR`: Yorkie API server address\n\n### Server-side\n\n- `YORKIE_API_SECRET_KEY`: Your Yorkie secret key (used in API routes only)\n\n## üß™ Testing\n\n1. Open the app in multiple browser windows or tabs\n2. Select different rooms in each window\n3. Watch the presence counters update in real-time\n4. Try switching rooms to see independent tracking\n\n## üìö Learn More\n\n- [Yorkie Documentation](https://yorkie.dev/docs)\n- [Yorkie JS SDK](https://github.com/yorkie-team/yorkie-js-sdk)\n- [Next.js Documentation](https://nextjs.org/docs)\n- [Next.js API Routes](https://nextjs.org/docs/app/building-your-application/routing/route-handlers)\n\n## ü§ù Contributing\n\nContributions are welcome! Please check out our [contributing guidelines](../../CONTRIBUTING.md).\n\n## üìÑ License\n\nApache License 2.0\n"},{"isFile":true,"isOpen":false,"language":"mjs","name":"eslint.config.mjs","path":"/eslint.config.mjs","content":"import nextConfig from 'eslint-config-next';\n\nconst eslintConfig = [...nextConfig];\n\nexport default eslintConfig;\n"},{"isFile":true,"isOpen":false,"language":"typescript","name":"next.config.ts","path":"/next.config.ts","content":"import type { NextConfig } from 'next';\n\nconst nextConfig: NextConfig = {\n  output: 'export',\n  distDir: 'dist',\n  basePath: process.env.NEXT_PUBLIC_BASE_PATH || '',\n  assetPrefix: process.env.NEXT_PUBLIC_BASE_PATH || '',\n  reactStrictMode: false,\n};\n\nexport default nextConfig;\n"},{"isFile":true,"isOpen":false,"language":"json","name":"package.json","path":"/package.json","content":"{\n  \"name\": \"nextjs-presence\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"eslint .\"\n  },\n  \"dependencies\": {\n    \"@yorkie-js/react\": \"^0.6.41\",\n    \"@yorkie-js/sdk\": \"^0.6.41\",\n    \"next\": \"16.0.7\",\n    \"react\": \"19.2.1\",\n    \"react-dom\": \"19.2.1\"\n  },\n  \"devDependencies\": {\n    \"@types/node\": \"^24.10.1\",\n    \"@types/react\": \"^19.2.7\",\n    \"@types/react-dom\": \"^19.2.3\",\n    \"eslint\": \"^9.39.1\",\n    \"eslint-config-next\": \"16.0.7\",\n    \"typescript\": \"^5.9.3\"\n  }\n}\n"},{"isFile":true,"isOpen":false,"language":"json","name":"tsconfig.json","path":"/tsconfig.json","content":"{\n  \"compilerOptions\": {\n    \"target\": \"ESNext\",\n    \"lib\": [\n      \"dom\",\n      \"dom.iterable\",\n      \"esnext\"\n    ],\n    \"allowJs\": false,\n    \"skipLibCheck\": true,\n    \"strict\": false,\n    \"noEmit\": true,\n    \"esModuleInterop\": true,\n    \"module\": \"EsNext\",\n    \"moduleResolution\": \"Node\",\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"jsx\": \"react-jsx\",\n    \"incremental\": true,\n    \"plugins\": [\n      {\n        \"name\": \"next\"\n      }\n    ],\n    \"paths\": {\n      \"@/*\": [\n        \"./*\"\n      ],\n      \"react\": [\n        \"./node_modules/@types/react\"\n      ],\n      \"@yorkie-js/sdk/src/*\": [\n        \"../../packages/sdk/src/*\"\n      ]\n    }\n  },\n  \"include\": [\n    \"**/*.ts\",\n    \"**/*.tsx\",\n    \".next/types/**/*.ts\",\n    \"next-env.d.ts\",\n    \"dist/types/**/*.ts\",\n    \".next/dev/types/**/*.ts\",\n    \"dist/dev/types/**/*.ts\"\n  ],\n  \"exclude\": [\n    \"node_modules\"\n  ]\n}\n"}]}